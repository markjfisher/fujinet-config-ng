Given basic atari setup test
  Given I have a simple overclocked 6502 system
   And I enable trace with indent
   And I create or clear directory "build/tests"
   And I load labels "inc/atari/atari.inc"
   And I load labels "inc/atari/atari_gtia.inc"
   And I load labels "inc/atari/atari_antic.inc"
   And I load labels "inc/atari/atari_pokey.inc"
   And I start compiling for atari in "build/tests" with config "features/atari/atari.cfg"

Given perform mads compile of test.a
  When I run the command line: mads -s -o:build/tests/test.xex -t:build/tests/test.lbl build/tests/test.a
   And I load xex "build/tests/test.xex"
   And I convert mads-labels file "build/tests/test.lbl" to acme labels file "build/tests/test.al"
   And I load labels "build/tests/test.al"

Given I mads-compile "*" from "*"
  When I run the command line: mads -o:build/tests/$1.obx -i:build/tests -t:build/tests/$1.lbl -l:build/tests/$1.lst $2

Given I build and load the mads-application "*" from "*"
  When I run the command line: mads -s -i:build/tests -o:build/tests/$1.xex -t:build/tests/$1.lbl -l:build/tests/$1.lst $2
   And I load xex "build/tests/$1.xex"
   And I convert mads-labels file "build/tests/$1.lbl" to acme labels file "build/tests/$1.al"
   And I load labels "build/tests/$1.al"

Given I patch machine with file "*"
  And I mads-compile "$1" from "build/tests/$1.asm"
  And I convert mads-labels file "build/tests/$1.lbl" to acme labels file "build/tests/$1.al"
  And I patch machine from obx file "build/tests/$1"

Given I ca65-compile "*" from "*"
  When I run the command line: cl65 -t atari -c --create-dep build/tests/$1.d -l build/tests/$1.lst -o build/tests/$1.o $2

Given I build and load the application "*" from "*" with "*"
  When I run the command line: cl65 -t atari -c --create-dep build/tests/$1.d -l build/tests/$1.lst -o build/tests/$1.o $2
  When I run the command line: cl65 -t atari -vm --mapfile build/tests/$1.map -l build/tests/$1.lst -Ln build/tests/$1.lbl -o build/tests/$1.com -C ../../src/atari/atari.cfg $3 build/tests/$1.o
   And I load xex "build/tests/$1.com"
   And I convert vice-labels file "build/tests/$1.lbl" to acme labels file "build/tests/$1.al"
   And I load labels "build/tests/$1.al"
